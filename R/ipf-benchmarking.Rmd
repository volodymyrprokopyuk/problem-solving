---
title: IPF benchmarking
---

```{r report-configuraiton}
opts_chunk$set(error = F, dev = "svglite")
```

```{r summary-per-action, eval = T, echo = F}
data <- metrics |>
  filter(benchmark_name == "Benchmark 0001") |>
  group_by(app_name, benchmark_name, module_name, action_name) |>
  summarize(elapsed_time = median(elapsed_time))

data |>
  ggplot(aes(x = action_name, y = elapsed_time, fill = action_name)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 30, hjust = 1.1))

data |>
  ggplot(aes(x = module_name, y = elapsed_time, fill = action_name)) +
  geom_col(position = position_stack(reverse = T))

data |>
  ggplot(aes(
    x = action_name,
    y = elapsed_time |> as.numeric() |> cumsum(),
    fill = action_name
  )) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 30, hjust = 1.1))

data |>
  ggplot(aes(x = action_name, y = elapsed_time, fill = action_name)) +
  geom_col(width = 1) +
  coord_polar(theta = "x")

data |>
  ggplot(aes(x = "", y = elapsed_time, fill = action_name)) +
  geom_col(width = 1, position = "fill") +
  coord_polar(theta = "y") +
  scale_y_continuous(labels = scales::percent) +
  facet_grid(~module_name)

data |>
  ggplot(aes(x = elapsed_time, y = action_name, color = module_name)) +
  geom_point(size = 3) +
  geom_segment(aes(xend = 0, yend = action_name))

# metrics |>
#   ggplot(aes(x = action_name, y = elapsed_time)) + geom_boxplot()
# metrics |>
#   group_by(module_name, action_name) |> summarize(elapsed_time = mean(elapsed_time)) |>
#   ggplot(aes(x = action_name, y = elapsed_time, fill = module_name)) + geom_col()
```

```{r distribution-per-iteration, eval = T, echo = F}
per_iteration <- metrics |>
  filter(benchmark_name == "Benchmark 0001") |>
  group_by(app_name, benchmark_name, iteration_name) |>
  summarize(elapsed_time = sum(elapsed_time))

per_iteration |>
  ggplot(aes(x = iteration_name, y = elapsed_time, group = 1)) +
  geom_point(size = 3) +
  geom_line() +
  geom_smooth() +
  theme(axis.text.x = element_text(angle = 30, hjust = 1.1))
```
